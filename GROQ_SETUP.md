# 🤖 Groq AI 助手配置指南

## 第一步：本地开发环境配置

### 1. 创建本地 `.env` 文件

复制 `env.example` 并重命名为 `.env`：

```bash
# Windows
copy env.example .env

# Linux/Mac
cp env.example .env
```

### 2. 编辑 `.env` 文件

打开 `.env` 文件，找到以下行并替换为你的 API Key：

```
GROQ_API_KEY=your_groq_api_key_here
```

**注意：** 请替换 `your_groq_api_key_here` 为你的真实 Groq API Key（格式：`gsk_...`）。

### 3. 确认 JWT_SECRET 已配置

```
JWT_SECRET=your-secret-key
```

### 4. 保存并重启服务器

```bash
npm start
```

---

## 第二步：Vercel 生产环境配置

### 1. 访问 Vercel Dashboard

打开：https://vercel.com/dashboard

### 2. 选择项目

点击你的项目：`workflow-tracker`

### 3. 配置环境变量

1. 点击顶部的 **"Settings"** 标签
2. 在左侧菜单选择 **"Environment Variables"**
3. 添加以下环境变量：

#### 必需的环境变量：

| 变量名 | 值 | 说明 |
|--------|-----|------|
| `GROQ_API_KEY` | `your_groq_api_key` | Groq AI API 密钥（格式：gsk_...） |
| `JWT_SECRET` | `your-secret-key` | JWT 加密密钥 |
| `DATABASE_URL` | `见 env.example` | PostgreSQL 连接字符串 |

#### 添加步骤：

1. 点击 **"Add New"** 按钮
2. **Name**: 输入变量名（如 `GROQ_API_KEY`）
3. **Value**: 粘贴对应的值
4. **Environment**: 选择 `Production`, `Preview`, `Development` 全选
5. 点击 **"Save"**
6. 重复以上步骤添加所有变量

### 4. 重新部署

添加完环境变量后，需要重新部署：

1. 点击顶部的 **"Deployments"** 标签
2. 找到最新的部署
3. 点击右侧的 **"..."** 菜单
4. 选择 **"Redeploy"**
5. 确认重新部署

或者，直接推送新代码到 GitHub，Vercel 会自动部署。

---

## 第三步：测试 AI 助手

### 本地测试：

1. 启动服务器：`npm start`
2. 访问：http://localhost:3000
3. 登录系统
4. 点击右下角的 **AI 机器人图标**
5. 在聊天窗口输入：`创建一个任务`

### Vercel 测试：

1. 等待 Vercel 部署完成（约 2-3 分钟）
2. 访问你的 Vercel URL（如：https://workflow-tracker-xxx.vercel.app）
3. 登录系统
4. 点击右下角的 **AI 机器人图标**
5. 测试对话功能

---

## AI 助手功能说明

### 🎯 主要功能

1. **智能任务创建**
   - 自然语言描述任务
   - 自动提取关键信息
   - 智能识别部门类型

2. **多轮对话**
   - 逐步引导补充信息
   - 智能提示必填项
   - 支持修改已输入信息

3. **部门识别**
   - 自动判断任务所属部门
   - 根据部门类型引导填写特有字段
   - 支持 4 个部门：产业分析、创意实践、活动策划、资源拓展

### 💬 使用示例

#### 简单创建：
```
用户: "创建一个任务"
AI: "好的！请告诉我这个任务的基本信息：
     1. 任务名称是什么？
     2. 负责人是谁？
     3. 优先级如何？"
```

#### 智能创建：
```
用户: "帮我创建一个新能源汽车市场分析任务，负责人张三，优先级高，下个月15号完成"
AI: "好的，我理解了：
     - 任务名称：新能源汽车市场分析
     - 负责人：张三
     - 优先级：高
     - 截止时间：下个月15号
     - 部门：产业分析（自动识别）
     
     这是一个市场分析任务，还需要补充：
     1. 分析类型？（市场分析/竞品分析/行业研究）
     2. 目标行业？
     3. 数据来源？"
```

#### 确认创建：
```
AI: "✅ 任务信息已完成！
     
     [显示完整任务信息表格]
     
     [确认创建] [重新填写]"
```

---

## 🔧 故障排查

### 问题 1: AI 助手不显示

**解决方案：**
- 清除浏览器缓存（Ctrl + Shift + R）
- 检查浏览器控制台是否有错误
- 确认已登录系统

### 问题 2: AI 无法回复

**可能原因：**
1. `GROQ_API_KEY` 未配置
2. API Key 无效
3. 超过 Groq 免费配额

**解决方案：**
- 检查环境变量是否正确配置
- 在 Groq Console 检查 API Key 状态
- 查看 Vercel 函数日志

### 问题 3: 创建任务失败

**可能原因：**
1. 数据库连接问题
2. 权限配置问题

**解决方案：**
- 检查 `DATABASE_URL` 环境变量
- 在 Supabase 执行权限修复 SQL

---

## 📊 Groq API 限制

### 免费层限制：

- **请求限制**: 30 RPM (每分钟30次请求)
- **Token 限制**: 6,000 TPM (每分钟6000个token)
- **每日限制**: 14,400 RPD (每天14400次请求)

### 超过限制后：

1. 返回 429 错误（Too Many Requests）
2. AI 助手会显示友好错误提示
3. 等待 1 分钟后自动恢复

### 优化建议：

- 合理使用 AI 功能
- 避免频繁刷新对话
- 清除不必要的对话历史

---

## 🎉 完成！

现在你的 AI 助手已经配置完成，可以开始使用了！

**下一步：**
1. ✅ 本地测试 AI 对话
2. ✅ 在 Vercel 配置环境变量
3. ✅ 测试生产环境
4. ✅ 享受 AI 智能创建任务的便利！

---

## 🆘 需要帮助？

如果遇到问题，请提供：
1. 错误信息截图
2. 浏览器控制台日志
3. Vercel 函数日志

我会帮你快速解决！

