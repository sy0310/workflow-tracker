# AI 任务创建 - 默认值规则

## 📋 概述

为了提升用户体验，AI 任务创建现在支持自动填充默认值。用户只需提供最基本的信息（任务名称），系统会自动补充其他字段。

## 🎯 默认值列表

| 字段 | 是否必填 | 默认值 | 说明 |
|------|---------|--------|------|
| 任务名称 | ✅ 必填 | 无 | 必须由用户提供 |
| 任务描述 | ❌ 选填 | `暂无描述` | 如果为空，使用此默认值 |
| 负责人 | ❌ 选填 | 当前用户 | 自动使用创建任务的用户 |
| 优先级 | ❌ 选填 | `中` | 可选：低/中/高/紧急 |
| 状态 | ❌ 选填 | `待开始` | 可选：待开始/进行中/已完成/已取消 |
| 开始时间 | ❌ 选填 | 当前日期 | 格式：YYYY-MM-DD |
| 预计完成时间 | ❌ 选填 | 开始时间 + 7天 | 自动计算 |
| 部门 | ❌ 选填 | 无 | 如果不指定，创建通用任务 |

## 💡 使用示例

### 示例 1: 最简单的任务创建

**用户输入：**
```
创建一个测试任务
```

**AI 返回：**
```json
{
  "任务名称": "测试任务"
}
```

**系统自动填充为：**
```json
{
  "任务名称": "测试任务",
  "任务描述": "暂无描述",
  "负责人": "当前用户名",
  "优先级": "中",
  "状态": "待开始",
  "开始时间": "2024-01-15",
  "预计完成时间": "2024-01-22"
}
```

### 示例 2: 部分信息的任务

**用户输入：**
```
创建一个市场调研任务，优先级高
```

**AI 返回：**
```json
{
  "任务名称": "市场调研任务",
  "优先级": "高"
}
```

**系统自动填充为：**
```json
{
  "任务名称": "市场调研任务",
  "任务描述": "暂无描述",
  "负责人": "当前用户名",
  "优先级": "高",
  "状态": "待开始",
  "开始时间": "2024-01-15",
  "预计完成时间": "2024-01-22"
}
```

### 示例 3: 完整信息的任务

**用户输入：**
```
创建一个产业分析任务，分析新能源汽车市场，负责人张三，优先级紧急，截止日期2024年2月1日
```

**AI 返回：**
```json
{
  "部门": "产业分析",
  "任务名称": "新能源汽车市场分析",
  "任务描述": "分析新能源汽车市场",
  "负责人": "张三",
  "优先级": "紧急",
  "预计完成时间": "2024年2月1日"
}
```

**系统自动填充为：**
```json
{
  "部门": "产业分析",
  "任务名称": "新能源汽车市场分析",
  "任务描述": "分析新能源汽车市场",
  "负责人": "张三",
  "优先级": "紧急",
  "状态": "待开始",
  "开始时间": "2024-01-15",
  "预计完成时间": "2024-02-01"
}
```

## 📅 日期格式自动转换

系统支持多种日期格式，会自动转换为标准格式：

| 输入格式 | 转换结果 |
|---------|---------|
| `2024年12月31日` | `2024-12-31` |
| `2024/12/31` | `2024-12-31` |
| `2024.12.31` | `2024-12-31` |
| `2024-12-31` | `2024-12-31` （保持不变）|

## 🔧 优先级和状态映射

### 优先级
- 低 → 1
- 中 → 2（默认）
- 高 → 3
- 紧急 → 4

### 状态
- 待开始 → 1（默认）
- 进行中 → 2
- 已完成 → 3
- 已取消 → 4

## 🎨 用户体验优化

### AI 助手行为

1. **快速创建模式**
   - 用户只提供任务名称
   - AI 直接生成 JSON
   - 系统自动填充默认值
   - 创建成功

2. **引导模式**
   - 用户提供基本信息
   - AI 询问关键字段（但不过于繁琐）
   - 用户可以选择提供更多信息或直接确认
   - 系统填充缺失字段

3. **完整模式**
   - 用户提供所有信息
   - AI 直接生成完整 JSON
   - 无需填充默认值
   - 创建成功

## 📝 服务器日志示例

当使用默认值时，服务器会记录：

```
🔧 填充默认值...
📝 使用默认任务描述
📝 使用默认优先级: 中
📝 使用默认状态: 待开始
📝 使用默认负责人: admin
📝 使用默认开始时间: 2024-01-15
📝 使用默认预计完成时间（7天后）: 2024-01-22
✅ 默认值填充和日期转换完成
```

## ✨ 优点

1. **降低使用门槛** - 用户只需提供任务名称即可快速创建任务
2. **灵活性** - 用户可以选择提供详细信息或使用默认值
3. **智能化** - 系统自动计算合理的默认值（如7天后的截止时间）
4. **容错性** - 即使信息不完整也能成功创建任务
5. **用户友好** - 减少繁琐的信息填写过程

## 🚀 快速测试

### 测试用例 1: 最简化
```
输入: "创建一个任务"
预期: 成功创建，所有字段使用默认值
```

### 测试用例 2: 只有名称
```
输入: "创建一个产品需求分析任务"
预期: 成功创建，名称正确，其他字段使用默认值
```

### 测试用例 3: 部分信息
```
输入: "创建一个会议准备任务，优先级高"
预期: 成功创建，优先级为高，其他字段使用默认值
```

### 测试用例 4: 完整信息
```
输入: "创建一个市场调研任务，负责人张三，优先级紧急，本月底完成"
预期: 成功创建，所有提供的信息都被正确使用
```

## 📞 注意事项

1. **任务名称是唯一必填字段** - 没有任务名称无法创建任务
2. **负责人默认为当前用户** - 确保用户已登录
3. **时间默认值基于当前时间** - 会根据服务器时间计算
4. **部门识别** - AI 会尝试识别部门，如果无法识别则创建通用任务
5. **日期格式** - 建议使用标准格式，但系统会尽力转换其他格式

## 🎯 总结

默认值功能让 AI 任务创建更加灵活和用户友好，用户可以：
- ✅ 快速创建简单任务（只需任务名称）
- ✅ 按需提供详细信息
- ✅ 不用担心遗漏字段
- ✅ 享受流畅的创建体验

